---
layout: post
title: Scala知识点整理
tag: Scala
---

```scala
val sparkSession = SparkSession.builder().master("local[2]").appName("test").getOrCreate()
val snRDD = sparkSession.sparkContext.makeRDD(Array("Just for Test")).cache
snRDD
  .repartition(1)
  .mapPartitions[String] { snOfPartition =>
     try {
       println(s"try func ...")
       val result = snOfPartition.toArray
         .groupBy { x =>
           println(s"try - groupBy func ...")
           x
         }
         .map { x =>
           println(s"try - map func ...")
           x._2
         }
         .toIterator
         .flatMap { x =>
           println(s"try - flatMap func ...")
           Array("Just for test.")
         }
       result
     } finally {
       println(s"finally func ...")
     }
  }
  .collect()
```
　　这段代码的执行顺序如下
```console
try func ...
try - groupBy func ...
try - map func ...
finally func ...
try - flatMap func ...
```