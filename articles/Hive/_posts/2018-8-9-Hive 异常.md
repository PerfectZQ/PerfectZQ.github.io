---
layout: post
title: Hive 异常
tag: Hive
---
## HDFS 对应分区目录下有数据文件，但是 Hive 查不到数据
Hive 查询数据会先查找 metastore，然后根据 metadata 去读取 warehouse 中的数据文件，如果直接将数据文件放到对应 hdfs 目录下，而没有更新 metadata 的话就会出现这种问题。

```shell
# 查看 Hive metastore，是否有对应的分区信息
mysql -u hive -p
mysql> select * from hive.PARTITIONS;

# 如果没有，可以通过下面的方法解决
# 方法1：metastore check，它会将检测到的分区信息写入 metastore
msck repair table tablename
# 方法2：
alter table hive_tablename add partition(day='20180306');
```
