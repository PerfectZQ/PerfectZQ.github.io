---
layout: post
title: Hive 核心概念
tag: Hive
---
## 数据单位
　　按粒度从大大到小
### Databases
　　数据库限定一个命名空间，这样就可以避免表、视图、分区、列的命名冲突。也可以限定一组用户的访问权限。
### Tables
　　具有相同模式(Schema)的同类数据构成的集合，存储到一张表中。例如一张表的模式包含`userid`、`username`、`password`、`datetime`等列。
### Partitions
　　表可以用一到多个`partitionKeys`决定数据的存储方式。Partition 除了作为存储单元之外，还允许用户高效的识别满足特定标准的行(记录)，例如有两个类型为`STRING`的`partitionKey`，`date_partiton`和`counrty_partiton`，每一个唯一的`partitionKey`值，如`date_partition=2018-05-09`都对应了表中的一个`partition`。另外需要注意的是，`date_partiton=2018-05-09`的数据并不一定就是`2018-05-09`这一天的全部数据，他不能代替`select * from table.t where t.datetime = '2018-05-09'`，只要你将一条数据的`date_partiton`指定为`2018-05-09`，不管它的`datetime`列实际上是哪一天的，他都会被分到`date_partition=2018-05-09`这个分区。指定`partitionKey`只是为了方便查询、加快分析速度，并且**分区列是虚拟列，它们不是数据本身的一部分，而是在加载时派生的。**
### Buckets(or Clusters)
　　每个分区的数据可以根据表中的实际列的Hash值分为桶(簇)。注意是表中的实列，而不是分区列。这样可以有效的帮助数据采样。

　　不一定非要把表进行分区或分桶，但是分区或分桶可以大幅度的缩减查询数据集，从而提高查询效率。

## 数据类型
　　Hive 支持原始(primitive)和复杂(complex)数据类型。
### Primitive Type

#### Integers
* TINYINT：  1 byte integer
* SMALLINT： 2 byte integer
* INT：      4 byte integer
* BIGINT：   8 byte integer

#### Boolean type
* BOOLEAN：  TRUE/FALSE

#### Floating point numbers
* FLOAT：  Single precision
* DOUBLE： Double precision

#### Fixed point numbers
* DECIMAL：a fixed point value of user defined scale and precision

#### String types
* STRING： sequence of characters in a specified character set
* VARCHAR：sequence of characters in a specified character set with a maximum length
* CHAR：   sequence of characters in a specified character set with a defined length

#### Date and time types
* TIMESTAMP：a specific point in time, up to nanosecond precision
* DATE：a date

#### Binary types
* BINARY：a sequence of bytes

　　隐式类型转换规则：`PrimitiveType > Number > DOUBLE > FLOAT > BIGINT > INT > SMALLINT > TINYINT`、`STRING > BOOLEAN`

　　当查询表达式所需要的数据类型`Type1`是元数据类型`Type2`的父类型，那么元数据就会被隐式转换为`Type1`。另外，Hive 的类型层次允许将`STRING`隐式转换成`DOUBLE`。

　　对于显示类型转换，可以使用 Hive 的`cast`Operator。
