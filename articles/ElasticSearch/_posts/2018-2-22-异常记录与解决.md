---
layout: post
title: 异常记录与解决
tag: ElasticSearch
---

## 集群部分节点宕机

启动kibana后无法正常访问页面，看日志出现下面的异常

```console
...
Elasticsearch plugin is red
...
Elasticsearch is still initializing the kibana index
...
```

原因：集群部分节点宕机之后，kibana在es中的index .kibana的副本集个数出现问题

解决：参考[stackoverflow](https://stackoverflow.com/questions/31201051/elasticsearch-is-still-initializing-the-kibana-index)

方法1：

```console
# 删掉kibana的所有配置数据
curl -XDELETE http://localhost:9200/.kibana
# 或者
# 删掉 es 里的所有数据
curl -XDELETE http://localhost:9200/*
```

方法2：

```console
curl -s http://localhost:9200/.kibana/_recovery?pretty
curl -XPUT 'localhost:9200/.kibana/_settings' -d '
{
    "index" : {
        "number_of_replicas" : 0
    }
}'
```
