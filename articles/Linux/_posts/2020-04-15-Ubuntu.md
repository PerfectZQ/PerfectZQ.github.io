---
layout: post
title: Ubuntu
tag: Linux
---

## Windows 远程桌面连接 Ubuntu ECS
### XRDP
```shell
# 1. === Connect to remote Ubuntu ECS ===
$ sudo apt-get update
$ sudo apt-get upgrade -f
$ sudo apt-get clean

# Remove
# $ sudo apt-get remove --purge -y vnc4server tightvncserver xrdp xubuntu-desktop xfce4

# VNC (Virtual Network Console)
# $ sudo apt-get install -y vnc4server tightvncserver

# Install xrdp
$ sudo apt-get install -y xrdp

# Choose your ubuntu desktop env
$ sudo apt-get install ubuntu-desktop		    # Default Ubuntu desktop
$ sudo apt-get install ubuntu-gnome-desktop	    # Ubuntu Gnome (Official flavor)
$ sudo apt-get install xfce4			        # LXDE
$ sudo apt-get install lxde			            # LXDE
$ sudo apt-get install kubuntu-desktop		    # KDE

# `gdm3` is greater and `lightdm` is faster
$ sudo systemctl enable gdm
$ sudo systemctl start gdm

# Config for current user
$ echo "xfce4-session" > ~/.xsession
# Or you could add to this scripts for all users
$ vim /etc/xrdp/startwm.sh
# ===> Config for all users
echo "xfce4-session" > ~/.xsession

# Start service
$ sudo systemctl enable xrdp
$ sudo systemctl restart xrdp

# Allow xRDP through the local firewall if firewall is active
$ sudo ufw allow 3389/tcp

# 2. === Windows ===
$ Win + R
mstsc
# type Ubuntu's IP
# Xorg -> username & password
```

除了上述方法外，还可以直接使用现成的脚本安装 xrdp，[xRDP Installation Script (free)](http://www.c-nergy.be/products.html)
```shell
$ wget https://www.c-nergy.be/downloads/xrdp-installer-1.1.zip
$ unzip xrdp-installer-1.1.zip
$ chmod +x xrdp-installer-1.1.sh
$ ./xrdp-installer-1.1.sh
```

### VNC
在 Linux 上基于 VNC 协议的实现工具有很多，如 TigerVNC、TightVNC、Vino、x11VNC、VNC Server

#### Client 
* [Windows Client - VNC Viewer for Windows](https://www.realvnc.com/en/connect/download/viewer/)

#### Server 
```shell
# Install TigerVNC server
$ sudo apt install -y tigervnc-standalone-server tigervnc-xorg-extension tigervnc-viewer

# Install desktop
$ sudo apt install -y ubuntu-gnome-desktop

# Solve grey screen
$ sudo apt install --no-install-recommends -y ubuntu-desktop gnome-panel gnome-settings-daemon metacity nautilus gnome-terminal

# Install dpi
$ sudo apt-get install xfonts-100dpi
$ sudo apt-get install xfonts-75dpi

$ sudo systemctl enable gdm
$ sudo systemctl start gdm

# Config passwd 
$ vncpasswd

$ nano ~/.vnc/xstartup
#!/bin/sh
# Uncomment the following two lines for normal desktop:
export XKL_XMODMAP_DISABLE=1
unset SESSION_MANAGER
# exec /etc/X11/xinit/xinitrc
unset DBUS_SESSION_BUS_ADDRESS
gnome-panel &
gnmoe-settings-daemon &
metacity &
nautilus &
gnome-terminal &

# Usages
$ vncserver --help

# Open 0.0.0.0:5901, default 127.0.0.1:5901
$ vncserver -localhost no

# Close all remote desktops
$ vncserver -kill :*
```
